




















/* Mermaid & graph modal helpers + transitions */

/* Make modal body a flex column so inner panel can grow */
.modal-body{ display:flex; flex-direction:column; }

/* Panel containing the graph in the process modal should also be flex */
.modal-body > .panel{ display:flex; flex-direction:column; min-height:0; }

/* Graph stage fills remaining height; controlled height to fit by HEIGHT (not width) */
.graph-stage--modal{
  flex: 1 1 auto;
  min-height: 0;
  /* allow horizontal scroll only */
  overflow-x: auto;
  overflow-y: hidden;
  border:1px solid var(--border);
  border-radius:10px;
  padding:8px;
  background:#fff;
  height: 100%; /* fit to modal column height */
  /* stop flex centering to allow natural overflow width */
  display: block;
}

/* SVG should fit container height (width may overflow and scroll horizontally) */
.graph-stage--modal svg{ height:100%; width:auto; display:block; margin: 0 auto; }

/* Idle motion: subtle shimmer overlay (does not move SVG, keeps BCR stable) */
.graph-stage.idle-motion,
.graph-stage--modal.idle-motion{ position: relative; }
.graph-stage.idle-motion::after,
.graph-stage--modal.idle-motion::after{
  content:""; position:absolute; inset:0; pointer-events:none;
  background: linear-gradient(90deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.035) 50%, rgba(0,0,0,0) 100%);
  background-size: 200% 100%; animation: stageShimmer 6s ease-in-out infinite;
}
@keyframes stageShimmer{ 0%{ background-position: 0% 0 } 100%{ background-position: 100% 0 } }

/* Keep helper text styles */
.help-text{color:var(--muted); font-size:12px; margin-bottom:6px}
.error-text{color:#b91c1c}

/* ========= Graph layer transitions ========= */
svg.graph-layer{ opacity:0; transform: translateX(28px); transition: opacity .24s ease, transform .28s ease; }
svg.graph-layer.enter{ opacity:.01; transform: translateX(18px); }
svg.graph-layer.enter-active{ opacity:1; transform: translateX(0); }
svg.graph-layer.exit{ opacity:1; transform: translateX(0); }
svg.graph-layer.exit-active{ opacity:0; transform: translateX(-22px); }

@media (prefers-reduced-motion: reduce){
  svg.graph-layer{ transition:none; transform:none !important; }
}

/* ========= Node highlight styling ========= */
/* Make highlight visible even with htmlLabels and layered groups */
.graph-stage svg g.m-node-active > rect,
.graph-stage svg g.m-node-active > polygon,
.graph-stage svg g.m-node-active > path,
.graph-stage--modal svg g.m-node-active > rect,
.graph-stage--modal svg g.m-node-active > polygon,
.graph-stage--modal svg g.m-node-active > path{
  stroke:#f97316 !important; /* orange-500 */
  stroke-width:3px !important;
  fill-opacity:.96;
  filter: drop-shadow(0 0 6px rgba(249,115,22,.55));
  transition: stroke-width .12s ease, filter .12s ease, fill-opacity .12s ease;
}
/* If Mermaid wraps shapes deeper, cover descendants too */
.graph-stage svg g.m-node-active rect,
.graph-stage svg g.m-node-active polygon,
.graph-stage svg g.m-node-active path,
.graph-stage--modal svg g.m-node-active rect,
.graph-stage--modal svg g.m-node-active polygon,
.graph-stage--modal svg g.m-node-active path{
  stroke:#f97316 !important;
  stroke-width:3px !important;
}
/* Optional subtle pulse on first apply (can be added via JS later) */
/* .m-node-active{ animation: nodeGlow .6s ease-out 1; } */
@keyframes nodeGlow{ from{ filter: drop-shadow(0 0 0 rgba(249,115,22,0)); } to{ filter: drop-shadow(0 0 6px rgba(249,115,22,.55)); } }

/* ========= Graph toolbar (single-line, responsive) ========= */
.graph-wrap{ display:flex; flex-direction:column; min-height:0; }
.graph-wrap > .graph-stage{ flex:1 1 auto; min-height:0; }

.graph-toolbar{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:nowrap; /* force one line */
  overflow-x:auto; /* scroll if overflow */
  overflow-y:visible;
  white-space:nowrap; /* prevent internal wraps */
  padding:6px 8px;
  border-bottom:1px solid var(--border);
  background:#fff;
}
.graph-toolbar .group{
  display:flex; align-items:center; gap:8px;
  flex:0 0 auto; /* keep group inline */
}
.graph-toolbar .sep{ display:inline-block; width:1px; height:22px; background:var(--border); }
.graph-toolbar .btn, .graph-toolbar label.btn{ flex:0 0 auto; white-space:nowrap; }
.graph-toolbar .btn-group{ display:inline-flex; gap:6px; flex:0 0 auto; }

