{
  "type": "function",
  "function": {
    "name": "legifrance_legi",
    "displayName": "Légifrance LEGI v2 - Optimisé",
    "category": "documents",
    "tags": ["external_sources", "knowledge", "legal", "france"],
    "description": "Accès aux codes juridiques français (corpus LEGI). WORKFLOW RECOMMANDÉ : (1) list_codes UNE FOIS pour identifier le code → (2) get_code avec root_section_id + depth=8-10 + include_articles=true pour cibler directement → (3) get_articles pour le texte complet. OPTIMISATION : Utilisez TOUJOURS root_section_id si vous connaissez la section (Livre/Titre/Chapitre) pour réduire les tokens de 70-90%.",
    "parameters": {
      "type": "object",
      "properties": {
        "operation": {
          "type": "string",
          "enum": ["list_codes", "get_code", "get_articles"],
          "description": "Type d'opération. GUIDANCE : list_codes → get_code (ciblé) → get_articles"
        },
        "code_id": {
          "type": "string",
          "pattern": "^LEGITEXT[0-9]{12}$",
          "description": "[get_code] ID du code (OBLIGATOIRE). Exemples courants : LEGITEXT000006070721 (Code civil), LEGITEXT000006072050 (Code du travail), LEGITEXT000006070719 (Code pénal), LEGITEXT000005634379 (Code de commerce). Obtenez la liste complète via list_codes."
        },
        "root_section_id": {
          "type": "string",
          "pattern": "^LEGISCTA[0-9]{12}$",
          "description": "[get_code] ⚡ PRIORITAIRE : ID de la section racine pour cibler une branche spécifique (ex: Livre III, Titre XX, Chapitre sur le licenciement). RÉDUIT LES TOKENS DE 70-90% vs arborescence complète. Stratégie : Faites d'abord get_code(depth=3-4) pour identifier la section pertinente, puis ré-appelez avec ce root_section_id + depth=8-10 pour les articles."
        },
        "depth": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 4,
          "description": "[get_code] Profondeur de l'arborescence. GUIDE TACTIQUE : depth=3-4 pour EXPLORER (identifier sections, ~5-10k tokens), depth=8-10 pour RÉCUPÉRER ARTICLES (avec root_section_id + include_articles=true, ~3-8k tokens si ciblé). ATTENTION : depth=3 sur Code complet = 10-20k tokens, depth=10 sur Code complet = 50-100k tokens (ÉVITER). Toujours combiner depth élevé avec root_section_id."
        },
        "include_articles": {
          "type": "boolean",
          "default": true,
          "description": "[get_code] Inclure les IDs articles au niveau le plus profond. DEFAULT=true car permet de récupérer directement les IDs pour get_articles (workflow en 2 étapes au lieu de 3). Utilisez depth=8-10 avec ce paramètre."
        },
        "scope": {
          "type": "string",
          "enum": ["codes_en_vigueur", "codes_abroges", "all"],
          "default": "codes_en_vigueur",
          "description": "[list_codes] Scope des codes. codes_en_vigueur (76 codes, défaut) pour usage normal, codes_abroges pour recherche historique."
        },
        "nature": {
          "type": "string",
          "enum": ["CODE", "ARRETE", "DECRET", "LOI", "ORDONNANCE", "ALL"],
          "default": "CODE",
          "description": "[list_codes] Filtrer par nature. CODE (défaut, 76 codes juridiques) couvre 95% des besoins. ALL retourne 10000+ textes (TRÈS VERBEUX, éviter sauf besoin spécifique)."
        },
        "article_ids": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^LEGIARTI[0-9]{12}$"
          },
          "minItems": 1,
          "maxItems": 50,
          "description": "[get_articles] Liste des IDs articles (OBLIGATOIRE, max 50). OPTIMISATION : Regroupez TOUS les articles pertinents en un seul appel (batch) plutôt que plusieurs appels. Exemple : ['LEGIARTI000006449540', 'LEGIARTI000006449541', ...]"
        },
        "include_breadcrumb": {
          "type": "boolean",
          "default": true,
          "description": "[get_articles] Inclure le fil d'Ariane (Code > Livre > Titre > Article). RECOMMANDÉ=true pour citations professionnelles (+20% tokens mais qualité essentielle)."
        },
        "include_links": {
          "type": "boolean",
          "default": true,
          "description": "[get_articles] Inclure les liens juridiques (CITATION, MODIFIE, ABROGE, etc.). RECOMMANDÉ=true pour analyses juridiques complètes (+30% tokens mais indispensable pour tracer évolution législative). Mettez false uniquement pour consultation simple."
        },
        "date": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "[get_articles] Date pour version historique (YYYY-MM-DD, ex: 2020-01-15). Par défaut : version en vigueur aujourd'hui. Utilisez pour consulter l'état du droit à une date passée."
        }
      },
      "required": ["operation"],
      "additionalProperties": false
    }
  }
}
