{
  "type": "function",
  "function": {
    "name": "legifrance_consult",
    "displayName": "Légifrance Consult",
    "category": "documents",
    "tags": ["external_sources", "knowledge", "legal", "france"],
    "description": "Consultation du corpus juridique français (LEGI).\n\n[QUATRE OPERATIONS]\n\n1. list_codes : Lister tous les codes juridiques français (77 en vigueur, 31 abrogés)\n2. search_sections : Recherche textuelle de sections (très restrictive)\n3. get_section_tree : Navigation dans l'arborescence d'un code/section\n4. get_articles : Récupération du texte complet des articles\n\n[STRATEGIE RECOMMANDEE]\n\n1. list_codes pour obtenir les code_id disponibles\n2. get_section_tree(code_id, max_depth=2, include_articles=false) pour vue d'ensemble\n3. get_section_tree(section_id, max_depth=4, include_articles=true, max_size_kb=500) pour cibler\n4. get_articles en BATCH (max 25 IDs par appel)\n\n[ANTI-OVERLOAD - OBLIGATOIRE]\n- TOUJOURS utiliser max_size_kb (300 pour découverte, 500 pour ciblage)\n- JAMAIS get_section_tree sans section_id avec max_depth > 2\n- JAMAIS max_depth > 4 sans section_id ciblé\n- include_articles=false en phase de découverte (depth=2)\n- Si erreur taille : réduire max_depth OU cibler une sous-section",

    "parameters": {
      "type": "object",
      "properties": {
        "operation": {
          "type": "string",
          "enum": ["list_codes", "search_sections", "get_section_tree", "get_articles"],
          "description": "Type d'opération à effectuer.\n\n- list_codes : Liste tous les codes juridiques disponibles (RECOMMANDÉ en premier appel)\n- search_sections : Recherche textuelle de sections (restrictive, accents obligatoires)\n- get_section_tree : Navigation dans l'arborescence d'un code/section\n- get_articles : Récupération du texte complet des articles (batch recommandé)"
        },

        "scope": {
          "type": "string",
          "enum": ["codes_en_vigueur", "codes_abroges", "all"],
          "default": "codes_en_vigueur",
          "description": "[list_codes] Périmètre des codes à lister.\n\n- codes_en_vigueur (défaut) : 77 codes actuellement applicables\n- codes_abroges : 31 codes historiques\n- all : Tous les codes"
        },

        "nature": {
          "type": "string",
          "description": "[list_codes] Filtrer par nature du texte.\n\nExemples : 'CODE' (codes juridiques uniquement), 'ARRETE', 'DECRET'\nSi omis : retourne toutes les natures."
        },

        "query": {
          "type": "string",
          "minLength": 3,
          "maxLength": 50,
          "description": "[search_sections] Requête textuelle STRICTE.\n\n[REGLES CRITIQUES]\n- ACCENTS OBLIGATOIRES : 'société', 'gérant', 'président'\n- Expressions COMPLÈTES : 'société anonyme', 'contrat de travail'\n- Mots uniques les plus sûrs : 'administrateur', 'licenciement', 'gérant'\n- Acronymes NE FONCTIONNENT PAS : 'SARL', 'SA'\n- Si 0 résultats après 2 tentatives : basculer sur get_section_tree"
        },

        "code_id": {
          "type": "string",
          "pattern": "^LEGITEXT[0-9]{12}$",
          "description": "[search_sections, get_section_tree] ID du code juridique (format: LEGITEXT + 12 chiffres).\n\nObtenu via list_codes. Si inconnu, appeler d'abord list_codes."
        },

        "section_id": {
          "type": "string",
          "pattern": "^LEGISCTA[0-9]{12}$",
          "description": "[get_section_tree] ID de la section à explorer (format: LEGISCTA + 12 chiffres).\n\nObtenu via get_section_tree (navigation progressive) ou search_sections."
        },

        "article_ids": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^LEGIARTI[0-9]{12}$"
          },
          "minItems": 1,
          "maxItems": 25,
          "description": "[get_articles] Liste des IDs d'articles à récupérer (max 25 par appel).\n\nObtenu via get_section_tree avec include_articles=true."
        },

        "etat": {
          "type": "string",
          "enum": ["VIGUEUR", "ABROGE", "ALL"],
          "default": "VIGUEUR",
          "description": "Filtre sur l'état des articles/sections.\n\n- VIGUEUR (défaut) : Textes en vigueur actuellement\n- ABROGE : Textes abrogés\n- ALL : Tous les textes"
        },

        "max_depth": {
          "type": "integer",
          "minimum": 1,
          "maximum": 10,
          "default": 4,
          "description": "[get_section_tree] Profondeur d'exploration.\n\n- 2 : Vue d'ensemble (LIVRES/TITRES) — TOUJOURS commencer ici\n- 4 : Standard (CHAPITRES/SECTIONS/ARTICLES) — avec section_id ciblé\n- 6+ : Exhaustif — UNIQUEMENT si section_id très précis\n\nRÈGLE : max_depth > 2 INTERDIT sans section_id"
        },

        "include_articles": {
          "type": "boolean",
          "default": true,
          "description": "[get_section_tree] Inclure les IDs articles dans l'arbre.\n\n- false : Phase découverte (depth=2, vue structure seule)\n- true : Phase ciblage (depth=4, pour récupérer les article_ids)"
        },

        "max_size_kb": {
          "type": "integer",
          "minimum": 50,
          "maximum": 5000,
          "description": "[get_section_tree] OBLIGATOIRE. Limite taille de réponse en Ko.\n\nValeurs recommandées :\n- 300 : Phase découverte (depth=2)\n- 500 : Phase ciblage (depth=4 sur section)\n- 1000 : Si vraiment nécessaire\n\nSi dépassé : retourne un aperçu avec les sous-sections disponibles."
        },

        "include_breadcrumb": {
          "type": "boolean",
          "default": true,
          "description": "[get_articles, get_section_tree] Inclure le fil d'Ariane."
        },

        "include_links": {
          "type": "boolean",
          "default": false,
          "description": "[get_articles] Inclure les liens juridiques.\n\n- false (recommandé) : Texte seul, plus léger\n- true : Avec références croisées (plus lourd)"
        },

        "date": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "[get_articles] Date de version historique (YYYY-MM-DD). Omis = version actuelle."
        },

        "limit": {
          "type": "integer",
          "minimum": 1,
          "maximum": 100,
          "default": 20,
          "description": "[search_sections] Nombre maximum de résultats."
        }
      },
      "required": ["operation"],
      "additionalProperties": false
    }
  }
}
