{
  "id": "PLATFORM_BOARD",
  "version": "1.0",
  "description": "Build platform, compute board coords, paint 8x8 3x3 squares (white/black)",
  "interface": {"entry": "PLAT_X1", "exits": {"success": "INIT_PAINT"}},
  "nodes": [
    { "name": "PLAT_X1", "type": "transform", "handler": "add", "inputs": {"a":"${worker.chess.origin_center.x}", "b": -1 }, "outputs": {"result": "cycle.plat.x1"} },
    { "name": "PLAT_Z1", "type": "transform", "handler": "add", "inputs": {"a":"${worker.chess.origin_center.z}", "b": -1 }, "outputs": {"result": "cycle.plat.z1"} },

    { "name": "INIT_PLATFORM","type": "io", "handler": "http_tool", "inputs": {"tool":"minecraft_control","operation":"build_structure","block_type":"black_concrete","start_pos":{"x":"${cycle.plat.x1}","y":"${worker.chess.y_level}","z":"${cycle.plat.z1}"},"dimensions":{"width":24,"depth":24,"height":1},"shape":"platform"} },

    { "name": "BOARD_COORDS", "type": "transform", "handler": "board_coords", "inputs": {"origin":"${worker.chess.origin_center}", "axis":"${worker.chess.axis}", "case_size":"${worker.chess.case_size}", "y_level":"${worker.chess.y_level}", "white_near_origin":"${worker.chess.white_near_origin}"}, "outputs": {"squares":"cycle.mc.board.squares"} },

    { "name": "PAINT_TPL", "type": "transform", "handler": "template_map",
      "inputs": {
        "items": "${cycle.mc.board.squares}",
        "template": "execute positioned {{center.x}} {{center.y}} {{center.z}} run fill ~-1 ~ ~-1 ~1 ~ ~1 {{block}}",
        "color_map": {"light": "white_concrete", "dark": "black_concrete"},
        "round_coords": true
      },
      "outputs": {"commands": "cycle.mc.paint.cmds"}
    },
    { "name": "INIT_PAINT",   "type": "io", "handler": "http_tool", "inputs": {"tool":"minecraft_control","operation":"batch_commands","delay_ms":2,
      "commands": "${cycle.mc.paint.cmds}"
    } }
  ],
  "edges": [
    {"from":"PLAT_X1","to":"PLAT_Z1"},
    {"from":"PLAT_Z1","to":"INIT_PLATFORM"},
    {"from":"INIT_PLATFORM","to":"BOARD_COORDS"},
    {"from":"BOARD_COORDS","to":"PAINT_TPL"},
    {"from":"PAINT_TPL","to":"INIT_PAINT"}
  ]
}
