{
  "id": "GI_LEVER_FW",
  "version": "1.3",
  "description": "Place lever adjacent to the board (east side, centered on z), with a gold block base; no extra clear; simple fireworks stub + end message.",
  "interface": { "entry": "LEVER_START", "exits": { "done": "LEVER_DONE" } },
  "nodes": [
    { "name": "LEVER_START", "type": "transform", "handler": "set_value", "inputs": {"value": true} },

    { "name": "LEVER_X", "type": "transform", "handler": "add", "inputs": {"a": "${cycle.plat.x2}", "b": 2}, "outputs": {"result": "cycle.lever.x"} },
    { "name": "LEVER_Z", "type": "transform", "handler": "add", "inputs": {"a": "${cycle.plat.z1}", "b": 12}, "outputs": {"result": "cycle.lever.z"} },

    { "name": "SET_GOLD_BASE", "type": "io", "handler": "http_tool", "inputs": {"tool":"minecraft_control","operation":"execute_command","command":"setblock ${cycle.lever.x} ${worker.chess.y_level} ${cycle.lever.z} minecraft:gold_block"} },
    { "name": "SET_LEVER",     "type": "io", "handler": "http_tool", "inputs": {"tool":"minecraft_control","operation":"execute_command","command":"setblock ${cycle.lever.x} ${worker.chess.y_level + 1} ${cycle.lever.z} minecraft:lever[face=floor,facing=west,powered=false]"} },

    { "name": "INIT_FW_RIG",  "type": "io", "handler": "http_tool", "inputs": {"tool":"minecraft_control","operation":"batch_commands","delay_ms":30,"commands": ["say [INIT] Fireworks rig setup complete."]} },
    { "name": "INIT_FW_TEST", "type": "io", "handler": "http_tool", "inputs": {"tool":"minecraft_control","operation":"execute_command","command":"say [INIT] Fireworks rig ready"} },

    { "name": "MSG_LEVER_DONE", "type": "io", "handler": "http_tool", "inputs": {"tool":"minecraft_control","operation":"execute_command","command":"say [INIT] Lever placed"} },

    { "name": "LEVER_DONE",   "type": "transform", "handler": "set_value", "inputs": {"value": true} }
  ],
  "edges": [
    {"from": "LEVER_START", "to": "LEVER_X"},
    {"from": "LEVER_X", "to": "LEVER_Z"},

    {"from": "LEVER_Z", "to": "SET_GOLD_BASE"},
    {"from": "SET_GOLD_BASE", "to": "SET_LEVER"},

    {"from": "SET_LEVER", "to": "INIT_FW_RIG"},
    {"from": "INIT_FW_RIG", "to": "INIT_FW_TEST"},

    {"from": "INIT_FW_TEST", "to": "MSG_LEVER_DONE"},
    {"from": "MSG_LEVER_DONE", "to": "LEVER_DONE"}
  ]
}
