{
  "version": "1.0",
  "process_version": "1.0.2-final",
  "metadata": {
    "description": "Smart Daily Briefing FINAL: Multi-tool orchestration with location, date, astronomy, random, and routing decisions",
    "author": "orchestrator-production",
    "features": ["device_location", "date", "astronomy", "random", "math", "decisions"]
  },
  "worker_ctx": {
    "timezone": "UTC",
    "sleep_seconds": 3600
  },
  "graph": {
    "nodes": [
      {"name": "START", "type": "start"},
      {
        "name": "get_timestamp",
        "type": "io",
        "handler": "http_tool",
        "inputs": {"tool": "date", "operation": "now", "tz": "UTC"},
        "outputs": {"result": "cycle.data.timestamp"},
        "retry": {"max": 1, "delay_sec": 1},
        "timeout_sec": 10
      },
      {
        "name": "detect_location",
        "type": "io",
        "handler": "http_tool",
        "inputs": {"tool": "device_location", "operation": "get_location"},
        "outputs": {
          "location": "cycle.data.location",
          "coordinates": "cycle.data.coords"
        },
        "retry": {"max": 2, "delay_sec": 2},
        "timeout_sec": 15
      },
      {
        "name": "get_moon_phase",
        "type": "io",
        "handler": "http_tool",
        "inputs": {"tool": "astronomy", "operation": "moon_phase"},
        "outputs": {"phase": "cycle.data.moon"},
        "retry": {"max": 1, "delay_sec": 1},
        "timeout_sec": 10
      },
      {
        "name": "generate_random_seed",
        "type": "io",
        "handler": "http_tool",
        "inputs": {
          "tool": "random",
          "operation": "generate_integers",
          "min": 1,
          "max": 1000,
          "count": 1
        },
        "outputs": {"result": "cycle.data.seed"},
        "retry": {"max": 1, "delay_sec": 0.5},
        "timeout_sec": 10
      },
      {
        "name": "check_data_complete",
        "type": "decision",
        "decision": {"kind": "truthy", "input": "${cycle.data.timestamp}"}
      },
      {
        "name": "compute_success",
        "type": "transform",
        "handler": "sleep",
        "inputs": {"seconds": 0},
        "outputs": {"slept": "cycle.result.success"}
      },
      {
        "name": "compute_failure",
        "type": "transform",
        "handler": "sleep",
        "inputs": {"seconds": 0},
        "outputs": {"slept": "cycle.result.failed"}
      },
      {"name": "END", "type": "end"}
    ],
    "edges": [
      {"from": "START", "to": "get_timestamp"},
      {"from": "get_timestamp", "to": "detect_location"},
      {"from": "detect_location", "to": "get_moon_phase"},
      {"from": "get_moon_phase", "to": "generate_random_seed"},
      {"from": "generate_random_seed", "to": "check_data_complete"},
      {"from": "check_data_complete", "to": "compute_success", "when": "true"},
      {"from": "check_data_complete", "to": "compute_failure", "when": "false"},
      {"from": "compute_success", "to": "END"},
      {"from": "compute_failure", "to": "END"}
    ]
  },
  "scopes": [
    {"name": "data", "reset_on": ["START"], "seed": {}},
    {"name": "result", "reset_on": ["START"], "seed": {}}
  ],
  "graph_mermaid": "graph TD\n  START-->get_timestamp-->detect_location-->get_moon_phase-->generate_random_seed\n  generate_random_seed-->check_data_complete\n  check_data_complete-->|true|compute_success\n  check_data_complete-->|false|compute_failure\n  compute_success-->END\n  compute_failure-->END"
}
